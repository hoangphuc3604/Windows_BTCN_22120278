<Page
    x:Class="Windows_22120278.Views.DrawingPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:Windows_22120278.Views"
    xmlns:vm="using:Windows_22120278.ViewModels"
    xmlns:models="using:Windows_22120278_Data.models">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <!-- Toolbar Row -->
        <Border Grid.Row="0" 
                Background="LightGray"
                Padding="8,6"
                BorderThickness="0,0,0,1"
                BorderBrush="DarkGray"
                MaxHeight="120">
            <ScrollViewer VerticalScrollBarVisibility="Auto"
                         HorizontalScrollBarVisibility="Auto"
                         ZoomMode="Disabled">
                <StackPanel Orientation="Horizontal" MinHeight="80">
                    <!-- Shapes Group -->
                    <Border BorderBrush="DarkGray" 
                           BorderThickness="0,0,1,0"
                           Padding="8,4"
                           Margin="0,0,8,0">
                        <StackPanel>
                            <TextBlock Text="Shapes" 
                                      FontSize="11"
                                      FontWeight="SemiBold"
                                      HorizontalAlignment="Center"
                                      Margin="0,0,0,4" />
                            <StackPanel Orientation="Horizontal">
                                <Button Content="Line"
                                        Command="{Binding SelectToolCommand}"
                                        CommandParameter="{x:Bind models:ShapeType.Line, Mode=OneTime}"
                                        Width="60"
                                        Height="32"
                                        Margin="2,0">
                                    <ToolTipService.ToolTip>
                                        <ToolTip Content="Line" />
                                    </ToolTipService.ToolTip>
                                </Button>
                                <Button Content="Rect"
                                        Command="{Binding SelectToolCommand}"
                                        CommandParameter="{x:Bind models:ShapeType.Rectangle, Mode=OneTime}"
                                        Width="60"
                                        Height="32"
                                        Margin="2,0">
                                    <ToolTipService.ToolTip>
                                        <ToolTip Content="Rectangle" />
                                    </ToolTipService.ToolTip>
                                </Button>
                                <Button Content="Ellipse"
                                        Command="{Binding SelectToolCommand}"
                                        CommandParameter="{x:Bind models:ShapeType.Ellipse, Mode=OneTime}"
                                        Width="60"
                                        Height="32"
                                        Margin="2,0">
                                    <ToolTipService.ToolTip>
                                        <ToolTip Content="Ellipse" />
                                    </ToolTipService.ToolTip>
                                </Button>
                                <Button Content="Polygon"
                                        Command="{Binding SelectToolCommand}"
                                        CommandParameter="{x:Bind models:ShapeType.Polygon, Mode=OneTime}"
                                        Width="60"
                                        Height="32"
                                        Margin="2,0">
                                    <ToolTipService.ToolTip>
                                        <ToolTip Content="Polygon" />
                                    </ToolTipService.ToolTip>
                                </Button>
                            </StackPanel>
                        </StackPanel>
                    </Border>

                    <!-- Color Group -->
                    <Border BorderBrush="DarkGray" 
                           BorderThickness="0,0,1,0"
                           Padding="8,4"
                           Margin="0,0,8,0">
                        <StackPanel>
                            <TextBlock Text="Color" 
                                      FontSize="11"
                                      FontWeight="SemiBold"
                                      HorizontalAlignment="Center"
                                      Margin="0,0,0,4" />
                            <Button x:Name="ColorPickerButton"
                                    Width="80"
                                    Height="32"
                                    HorizontalAlignment="Center">
                                <Button.Flyout>
                                    <Flyout Placement="Bottom">
                                        <ColorPicker x:Name="ColorPickerControl"
                                                    ColorChanged="ColorPicker_ColorChanged"
                                                    IsAlphaEnabled="False"
                                                    IsColorSpectrumVisible="True"
                                                    IsColorChannelTextInputVisible="True"
                                                    IsHexInputVisible="True"
                                                    IsMoreButtonVisible="True"
                                                    Width="300" />
                                    </Flyout>
                                </Button.Flyout>
                                <Border x:Name="ColorPreviewBorder"
                                       Background="Black"
                                       BorderBrush="Black"
                                       BorderThickness="1"
                                       CornerRadius="2" />
                            </Button>
                        </StackPanel>
                    </Border>

                    <!-- Stroke Group -->
                    <Border BorderBrush="DarkGray" 
                           BorderThickness="0,0,1,0"
                           Padding="8,4"
                           Margin="0,0,8,0">
                        <StackPanel>
                            <TextBlock Text="Stroke" 
                                      FontSize="11"
                                      FontWeight="SemiBold"
                                      HorizontalAlignment="Center"
                                      Margin="0,0,0,4" />
                            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                <Slider Minimum="1" 
                                       Maximum="20" 
                                       Value="{Binding CurrentStrokeSize, Mode=TwoWay}"
                                       Width="80"
                                       VerticalAlignment="Center" />
                                <TextBlock Text="{Binding CurrentStrokeSize, Mode=OneWay}"
                                          Width="25"
                                          TextAlignment="Center"
                                          VerticalAlignment="Center"
                                          Margin="4,0,0,0"
                                          FontSize="11" />
                            </StackPanel>
                        </StackPanel>
                    </Border>

                    <!-- Actions Group -->
                    <Border Padding="8,4"
                           Margin="0,0,8,0">
                        <StackPanel>
                            <TextBlock Text="Actions" 
                                      FontSize="11"
                                      FontWeight="SemiBold"
                                      HorizontalAlignment="Center"
                                      Margin="0,0,0,4" />
                            <StackPanel Orientation="Horizontal">
                                <Button Content="Save"
                                        Command="{Binding SaveDrawingCommand}"
                                        Style="{StaticResource AccentButtonStyle}"
                                        Width="70"
                                        Height="32"
                                        Margin="2,0" />
                                <Button Content="Clear"
                                        Command="{Binding ClearCanvasCommand}"
                                        Style="{StaticResource DefaultButtonStyle}"
                                        Width="70"
                                        Height="32"
                                        Margin="2,0" />
                                <Button Content="Back"
                                        Click="BackButton_Click"
                                        Style="{StaticResource DefaultButtonStyle}"
                                        Width="70"
                                        Height="32"
                                        Margin="2,0" />
                            </StackPanel>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </ScrollViewer>
        </Border>

        <!-- Drawing Area Row -->
        <ScrollViewer Grid.Row="1">
            <Canvas x:Name="DrawingCanvas" 
                    Background="White"
                    PointerPressed="DrawingCanvas_PointerPressed"
                    PointerMoved="DrawingCanvas_PointerMoved"
                    PointerReleased="DrawingCanvas_PointerReleased"
                    PointerCanceled="DrawingCanvas_PointerReleased"
                    DoubleTapped="DrawingCanvas_DoubleTapped" />
        </ScrollViewer>
    </Grid>
</Page>
